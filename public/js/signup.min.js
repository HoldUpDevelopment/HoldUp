async function usernameHTTP(a){var e=new XMLHttpRequest;return await e.open("GET",`${origin}/user/getUserIdFromUserName?userName=${a}`,!1),e.send(null),JSON.parse(e.responseText)}async function emailHTTP(a){var e=new XMLHttpRequest;return await e.open("GET",`${origin}/user/getUserIdFromEmail?email=${a}`,!1),e.send(null),JSON.parse(e.responseText)}async function submitFormHTTP(a){var e=new XMLHttpRequest;return await e.open("POST",`${origin}/api/user/signup`,!1),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(a),e.responseText}function passwordIsValid(a){var e=/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/;return e.test(a)}function emailIsValid(a){var e=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\[\x01-\x09\x0b\x0c\x0e-\x7f])+)])/;return e.test(a)}function usernameIsValid(a){var e=/^(?=[a-zA-Z0-9._-]{4,20}$)(?!.*[_.-]{2})[^_.-].*[^_.-]$/;return e.test(a)}function validateTOC(a){$("#tocCheckbox").is(":checked")||($("#tocCheckbox").addClass("is-invalid"),a.isValid=!1)}async function validateEmail(a){var e=!0;if(""==$("#email-input").val())$("#email-input-warning").html('<div class="fw-normal">* This field is required</div>'),$("#username-input").addClass("is-invalid"),$("#email-input").removeClass("is-valid"),a.isValid=!1,e=!1;else if(!emailIsValid($("#email-input").val())&&e)$("#email-input").addClass("is-invalid"),$("#email-input").removeClass("is-valid"),$("#email-input-warning").html(emailHtmlDefault),a.isValid=!1,e=!1;else{var i=await emailHTTP($("#email-input").val());404!=i._id&&($("#email-input-warning").html('<div class="fw-normal">This email is already in use</div>'),$("#email-input").addClass("is-invalid"),$("#email-input").removeClass("is-valid"),a.isValid=!1,e=!1)}e&&($("#email-input").removeClass("is-invalid"),$("#email-input").addClass("is-valid"))}async function validateUsername(a){var e=!0;if(""==$("#username-input").val())$("#username-input-warning").html('<div class="fw-normal">* This field is required</div>'),$("#username-input").addClass("is-invalid"),$("#username-input").removeClass("is-valid"),a.isValid=!1,e=!1;else if(!usernameIsValid($("#username-input").val())&&e)$("#username-input").addClass("is-invalid"),$("#username-input").removeClass("is-valid"),$("#username-input-warning").html(usernameHtmlDefault),a.isValid=!1,e=!1;else{var i=await usernameHTTP($("#username-input").val());404!=i._id&&($("#username-input-warning").html('<div class="fw-normal">This username is already in use</div>'),$("#username-input").addClass("is-invalid"),$("#username-input").removeClass("is-valid"),a.isValid=!1,e=!1)}e&&($("#username-input").removeClass("is-invalid"),$("#username-input").addClass("is-valid"))}function checkPasswordFieldChanged(a){$("#password-input").val()!=$("#check-password-input").val()||""==$("#check-password-input").val()?($("#check-password-input").removeClass("is-valid"),$("#check-password-input").addClass("is-invalid"),a.classList.remove("was-validated")):($("#check-password-input").removeClass("is-invalid"),$("#check-password-input").addClass("is-valid"))}function passwordFieldChanged(a){passwordIsValid($("#password-input").val())?($("#password-input").removeClass("is-invalid"),$("#password-input").addClass("is-valid")):($("#password-input").addClass("is-invalid"),a.classList.remove("was-validated"))}async function submitData(a){$("#submit-button").html(submitSpinner),console.log("Sending...");var e=await submitFormHTTP(a);console.log(e)}var usernameHtmlDefault='Username must be:\n              <div class="fw-normal">4-20 characters long,</div>\n              <div class="fw-normal">Only contain letters, numbers, dots, or underscores,</div>\n              <div class="fw-normal">Can not start or end with a dot or underscore,</div>\n              <div class="fw-normal">Can not have consecutive dots or zeros</div>',emailHtmlDefault='Enter a valid Email address\n              <div class="fw-normal">(valid@email.com)</div>',submitSpinner='<div class="spinner-border text-light" role="status">\n                <span class="visually-hidden">Loading...</span>\n                </div>';const{host:host,hostname:hostname,href:href,origin:origin,pathname:pathname,port:port,protocol:protocol,search:search}=window.location;(()=>{"use strict";const a=document.querySelectorAll(".form-validator");var e=document.getElementById("signup-form");e.addEventListener("submit",async e=>{var i={isValid:!0};if(Array.from(a).forEach(a=>{""==a.value&&a.classList.add("is-invalid"),a.classList.contains("is-invalid")&&(i.isValid=!1)}),validateTOC(i),await validateEmail(i),await validateUsername(i),i.isValid){e.preventDefault();const a=new FormData(document.getElementById("signup-form")),i=new URLSearchParams(a).toString();await submitData(i),alert("Account successfully created!"),window.location.href=`${origin}/account/login`}else console.log("NOT VALID"),e.preventDefault(),e.stopPropagation()},!1);var i=document.getElementById("password-input");i.addEventListener("change",a=>{passwordFieldChanged(e),checkPasswordFieldChanged(e)},!1);var s=document.getElementById("check-password-input");s.addEventListener("change",a=>{checkPasswordFieldChanged(e)},!1);var n=document.getElementById("email-input");n.addEventListener("change",a=>{n.classList.contains("is-invalid")&&emailIsValid($("#email-input").val())&&$("#email-input").removeClass("is-invalid")},!1);var t=document.getElementById("username-input");t.addEventListener("change",a=>{t.classList.contains("is-invalid")&&usernameIsValid($("#username-input").val())&&$("#username-input").removeClass("is-invalid")},!1);var l=document.getElementById("tocCheckbox");l.addEventListener("change",a=>{$("#tocCheckbox").is(":checked")&&$("#tocCheckbox").removeClass("is-invalid")},!1)})();